<<<<<<< HEAD
=======
# --- Build Stage ---
>>>>>>> 243eb4f (dockerfileを本番用（build&start)に作成)
FROM node:20 AS build

WORKDIR /usr/src/app

COPY package*.json ./
RUN npm install --legacy-peer-deps

COPY . .
<<<<<<< HEAD
# Nuxt の静的ビルドを生成
RUN npm run build && npm run generate

# ホストへコピーできるように待機コマンド
CMD ["sh", "-c", "cp -r .output/public/* /dist/ && tail -f /dev/null"]
=======
RUN npm run build


# --- Production Stage ---
FROM node:20-alpine AS production

WORKDIR /usr/src/app

COPY --from=build /usr/src/app/.output ./.output

ENV NODE_ENV=production

EXPOSE 3000

CMD ["node", ".output/server/index.mjs"]
>>>>>>> 243eb4f (dockerfileを本番用（build&start)に作成)
